/*! For license information please see pentris.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["pentris"],{"./src/index.scss":(e,t,r)=>{r.r(t)},"./src/pentris.tsx":function(e,t,r){var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r("./node_modules/react/index.js")),c=r("./node_modules/react/index.js"),s=r("./node_modules/@hot-loader/react-dom/index.js");r("./src/index.scss");const i=c.createRef();s.render(o.createElement("canvas",{id:"canvas",className:"full_canvas",tabIndex:0,ref:i}),document.querySelector("#root"));const l=40,a="#D3EDED";var d,h,u,f=!1;const P=i.current,g=P.getContext("2d");window.onresize=S;const p={smallI:{color:"cyan",shape:[[!0],[!0],[!0],[!0]]},smallT:{color:"magenta",shape:[[!0,!0,!0],[!1,!0,!1]]},smallO:{color:"yellow",shape:[[!0,!0],[!0,!0]]},smallL:{color:"blue",shape:[[!0,!1],[!0,!1],[!0,!0]]},smallS:{color:"green",shape:[[!1,!0,!0],[!0,!0,!1]]},F:{color:"red",shape:[[!1,!0,!0],[!0,!0,!1],[!1,!0,!1]]},I:{color:"orange",shape:[[!0],[!0],[!0],[!0],[!0]]},L:{color:"lightyellow",shape:[[!0,!1],[!0,!1],[!0,!1],[!0,!0]]},N:{color:"lightgreen",shape:[[!1,!0],[!1,!0],[!0,!0],[!0,!1]]},P:{color:"lightblue",shape:[[!0,!0],[!0,!0],[!0,!1]]},T:{color:"pink",shape:[[!0,!0,!0],[!1,!0,!1],[!1,!0,!1]]},U:{color:"#9f1aff",shape:[[!0,!1,!0],[!0,!0,!0]]},V:{color:"#b3003b",shape:[[!0,!1,!1],[!0,!1,!1],[!0,!0,!0]]},W:{color:"#cc6600",shape:[[!0,!1,!1],[!0,!0,!1],[!1,!0,!0]]},X:{color:"#30b5b5",shape:[[!1,!0,!1],[!0,!0,!0],[!1,!0,!1]]},Y:{color:"#0059b3",shape:[[!0,!0,!0,!0],[!1,!0,!1,!1]]},Z:{color:"#ff667d",shape:[[!0,!0,!1],[!1,!0,!1],[!1,!0,!0]]}};class x{constructor(e,t){this.x=e,this.y=t}}const y=B(),w={board:K(14,20,""),fixedBoard:K(14,20,""),currentPiece:y,currentPosition:new x(6,0),currentShapeGrid:p[y].shape,nextPiece:B(),keysPressed:[],counter:0,waitTime:100,level:0,linesCleared:0,savedPiece:"",score:0,cPressed:!1};function b(e=""){const t=function(){const e=[];for(let t=0;t<w.board[0].length;t++){let r=!0;for(let e=0;e<w.board.length&&(""===w.board[e][t]&&(r=!1),r);e++);r&&e.push(t)}return e}();if(t.length>0){switch(w.linesCleared+=t.length,t.length){case 1:w.score+=40*(w.level+1);break;case 2:w.score+=100*(w.level+1);break;case 3:w.score+=300*(w.level+1);break;case 4:w.score+=1200*(w.level+1);break;default:w.score+=6e3*(w.level+1)}w.linesCleared%10==0&&(w.level++,w.waitTime=Math.ceil(Math.max(100-8*w.level,20))),function(e){for(let t=e[e.length-1];t>e.length-1;t--)for(let r=0;r<w.board.length;r++)w.board[r][t]=w.board[r][t-e.length];for(let t=0;t<e.length;t++)for(let e=0;e<w.board.length;e++)w.board[e][t]=""}(t)}w.fixedBoard=j(w.board),""!==e?w.currentPiece=e:(w.currentPiece=w.nextPiece,w.nextPiece=B()),w.currentPosition=new x(6,0),w.currentShapeGrid=j(p[w.currentPiece].shape),w.cPressed=!1}function k(e){switch(e.code){case"Tab":e.preventDefault();break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"Space":case"KeyX":case"KeyZ":case"KeyC":w.keysPressed.push(e.code)}}function v(e){"KeyR"===e.code&&(f=!1,document.removeEventListener("keydown",v),document.addEventListener("keydown",k),function(){const e=B();w.board=K(14,20,""),w.fixedBoard=K(14,20,""),w.currentPiece=e,w.currentPosition=new x(6,0),w.currentShapeGrid=p[e].shape,w.nextPiece=B(),w.keysPressed=[],w.counter=0,w.waitTime=100,w.level=0,w.linesCleared=0,w.savedPiece="",w.score=0,w.cPressed=!1}(),g.fillStyle=a,g.fillRect(0,0,P.width,P.height),m())}function m(){S(),A(w.currentShapeGrid,w.currentPosition,p[w.currentPiece].color),T(),C()}function S(){P.height=window.innerHeight,P.width=window.innerWidth,P.width/P.height<1.3&&(P.height=P.width/1.3),g.fillStyle=a,g.fillRect(0,0,P.width,P.height),d=(P.height-80)/20,h=14*d,u=(P.width-h)/2,f&&(T(),L())}function T(){const e="#737373";for(let t=0;t<w.board.length;t++){const r=w.board[t];for(let n=0;n<r.length;n++){let o;o=""===r[n]?"black":r[n];const c=new x(u+t*d,l+n*d);O(c.x,c.y,d-1,d-1,e,o)}}const t=new x(u+15*d,l),r=p[w.nextPiece].color;if(G(t,w.nextPiece,e,r),""!==w.savedPiece){const t=new x(u-7*d,l),r=p[w.savedPiece].color;G(t,w.savedPiece,e,r)}const n=new x(u+Math.floor(15*d),l+Math.floor(6*d));O(n.x,n.y,1e3,128,a,a),g.font="24px sans-serif",g.fillStyle="black",g.textAlign="left",g.fillText("Level: "+w.level,n.x,n.y),g.fillText("Score: "+w.score,n.x,n.y+24+Math.floor(d/2)),g.fillText("High Score: "+I(),n.x,n.y+48+Math.floor(d))}function G(e,t,r,n){for(let t=0;t<7;t++)for(let r=0;r<6;r++){const n=new x(e.x+t*d,e.y+r*d);O(n.x,n.y,d-1,d-1,a,a)}E(p[t].shape,((t,o,c)=>{if(c){const c=new x(e.x+(t+1)*d,e.y+(o+1)*d);O(c.x,c.y,d-1,d-1,r,n)}}))}function O(e,t,r,n,o,c){g.lineWidth=1,g.strokeStyle=o,g.beginPath(),g.rect(e,t,r,n),g.stroke(),g.fillStyle=c,g.fillRect(e+1,t+1,r-2,n-2)}function R(e,t){E(e,((e,r,n)=>{if(n){const n=new x(t.x+e,t.y+r);w.board[n.x][n.y]=""}}))}function A(e,t,r){E(e,((e,n,o)=>{if(o){const o=new x(t.x+e,t.y+n);w.board[o.x][o.y]=r}}))}function L(e=!1){g.globalAlpha=.85,g.fillStyle="white",g.fillRect(0,l+4.5*d,P.width,e?4*d:3*d),g.globalAlpha=1,g.font="48px sans-serif",g.fillStyle="black",g.textAlign="center",g.fillText("Game Over!",P.width/2,l+6*d),g.font="24px sans-serif",e?(g.fillText("Congratulations! You got a new high score!",P.width/2,l+7*d),g.fillText("Press R to play again.",P.width/2,l+8*d)):g.fillText("Press R to play again.",P.width/2,l+7*d),document.removeEventListener("keydown",k),document.addEventListener("keydown",v)}function C(){w.counter++,f=!1;let e=!1,t=!0;if(w.keysPressed.length>0){if(w.keysPressed.indexOf("ArrowDown")>=0&&M("D"),w.keysPressed.indexOf("ArrowLeft")>=0&&M("L"),w.keysPressed.indexOf("ArrowRight")>=0&&M("R"),w.keysPressed.indexOf("ArrowUp")>=0&&D(1),w.keysPressed.indexOf("Space")>=0){for(;M("D"););e=!0}if((w.keysPressed.indexOf("KeyX")>=0||w.keysPressed.indexOf("KeyZ")>=0)&&D(4),w.keysPressed.indexOf("KeyC")>=0&&!w.cPressed){R(w.currentShapeGrid,w.currentPosition);const e=w.savedPiece;w.savedPiece=w.currentPiece,""!==e?b(e):b(),w.cPressed=!0,A(w.currentShapeGrid,w.currentPosition,p[w.currentPiece].color),M("none",!1)||(f=!0),t=!1}w.keysPressed=[]}var r,n;t&&(e||w.counter%w.waitTime==0)&&(M("D")||(b(),A(w.currentShapeGrid,w.currentPosition,p[w.currentPiece].color),M("none",!1)||(f=!0)),w.counter=0),T(),f?w.score>I()?(r=w.score,(n=new Date).setTime(n.getTime()+31536e7),document.cookie="highScore="+r+";",L(!0)):L():setTimeout(C)}function D(e){const t=_(e,w.currentShapeGrid);let r=!1;return E(t,((e,t,n)=>{if(n){const n=new x(w.currentPosition.x+e,w.currentPosition.y+t);(n.x>=w.board.length||n.y>=w.board[0].length||n.x<0||n.y<0||""!==w.fixedBoard[n.x][n.y])&&(r=!0)}})),r||(R(w.currentShapeGrid,w.currentPosition),w.currentShapeGrid=t,A(w.currentShapeGrid,w.currentPosition,p[w.currentPiece].color)),!r}function M(e,t=!0){let r;switch(e){case"U":r=new x(w.currentPosition.x,w.currentPosition.y-1);break;case"D":r=new x(w.currentPosition.x,w.currentPosition.y+1);break;case"L":r=new x(w.currentPosition.x-1,w.currentPosition.y);break;case"R":r=new x(w.currentPosition.x+1,w.currentPosition.y);break;default:r=w.currentPosition}let n=!1;return E(w.currentShapeGrid,((e,t,o)=>{if(o){const o=new x(r.x+e,r.y+t);(o.x>=w.board.length||o.y>=w.board[0].length||o.x<0||o.y<0||""!==w.fixedBoard[o.x][o.y])&&(n=!0)}})),!n&&t&&(R(w.currentShapeGrid,w.currentPosition),w.currentPosition=r,A(w.currentShapeGrid,w.currentPosition,p[w.currentPiece].color)),!n}function _(e,t){let r;switch(e){case 0:return t;case 1:r=K(t[0].length,t.length,!1);for(let e=0;e<t.length;e++)for(let n=0;n<t[0].length;n++)r[r.length-1-n][e]=t[e][n];return r;case 2:return _(1,_(1,t));case 3:return _(1,_(2,t));case 4:r=K(t.length,t[0].length,!1);for(let e=0;e<t.length;e++)for(let n=0;n<t[0].length;n++)r[t.length-1-e][n]=t[e][n];return r;case 5:return _(4,_(1,t));case 6:return _(4,_(2,t));case 7:return _(4,_(3,t));default:throw"Non-Transformation entered to applyTransformation"}}function E(e,t){for(let r=0;r<e.length;r++)for(let n=0;n<e[0].length;n++)t(r,n,e[r][n])}function K(e,t,r){const n=[];for(let o=0;o<e;o++){const e=[];for(let n=0;n<t;n++)e.push(r);n.push(e)}return n}function j(e){const t=[];for(let r=0;r<e.length;r++){const n=[];for(let t=0;t<e[0].length;t++)n.push(e[r][t]);t.push(n)}return t}function B(){const e=Object.keys(p);return e[Math.floor(Math.random()*e.length)]}function I(){for(var e=decodeURIComponent(document.cookie).split(";"),t=0;t<e.length;t++){var r=e[t];if(0==r.indexOf("highScore"))return parseInt(r.substring("highScore".length+1,r.length))}return 0}document.addEventListener("keydown",k),m()}},e=>{e(e.s="./src/pentris.tsx")}]);